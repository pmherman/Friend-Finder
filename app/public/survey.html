<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Friend Finder Application - Survey</title>
        <!-- Twitter Bootstrap CDN -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <!-- Font Awesome CDN -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
        <!-- JQuery -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <!--page stylesheet -->
        <link rel="stylesheet" type="text/css" href="/css/stylesheet.css">
       <style>
            body {
                background-color: lightgrey; 
            }

            .title {
                font-family: 'Press Start 2P', cursive;
                color: #4468B0;
            }

            .chosen-select {
                background-color: #f7f7e6;
            }

            .form-control {
                width: 250px;
                margin: auto;
                background-color: #f7f7e6
            }

            #surveyQuestions {
                background-color: lightyellow;
                width: 60vw;
                padding: 1px;
                margin: auto;
            }

            .rules {
                color: red;
                font-weight: bolder;
            }

            #friendPhoto {
                height: 320px;
            }

            .error {
                background-color: #ffa296;
            }
       </style>
    </head>
    <body>
        <div class="container-fluid">
                <h2 class="title text-center">Friend Finder - Survey Questions</h2>
                <hr>
                <div id="surveyQuestions" class="text-center">
                <h4>Name: <span style="color:red">*</span></h4>
                <input type="text" id="name" class="form-control" required>
                <h4>Photo: <span style="color:red">*</span></h4>
                <input type="text" id="photo" class="form-control" required>
                <h4>1. You're a really big anime fan.</h4>
                <select class="chosen-select" id="q1">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>2. Having a friend with strong loyalty is important to you.</h4>
                <select class="chosen-select" id="q2">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>3. You thrive in stressful environments.</h4>
                <select class="chosen-select" id="q3">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>4. Family is important to you.</h4>
                <select class="chosen-select" id="q4">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>5. You are super easy going.</h4>
                <select class="chosen-select" id="q5">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>6. Physical exercise is very important to you.</h4>
                <select class="chosen-select" id="q6">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>7. You are very politcally minded.</h4>
                <select class="chosen-select" id="q7">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>8. Drinking with friends while playing video games is your kind of night.</h4>
                <select class="chosen-select" id="q8">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>9. You have some kind of collection in your home.</h4>
                <select class="chosen-select" id="q9">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
                <h4>10. You value coffee.</h4>
                <select class="chosen-select" id="q10">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
                </select>
                <hr>
                <p class="rules text-center">***Questions with a red astirix are required***</p>   
                <!-- Submit Button -->
                <button type="submit" class="btn btn-success btn-lg btn-block" id="submit"><span class="fa fa-check-circle" aria-hidden="true"></span> Submit</button>            
            </div>
        </div>
        <br>
        <footer class="text-center">
            <a href="/api/friends">Friends API</a> | <a href="https://github.com/pmherman/friendfinder">GitHub</a>
        </footer>
        <br>
        <!-- Error Modal -->
        <div id="errorModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
              <div class="error modal-content">
                <div class="modal-header text-center">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title">Friend Finder Alert:</h4>
                </div>
                <div class="modal-body text-center">
                  <h3>Please fill out the form completely to continue.</h3>
                </div>
                <div class="modal-footer">
                  <button type="button" id="close" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
              </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
          </div><!-- /.modal -->  
        <!-- Results Modal -->
        <div id="resultsModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header text-center">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title">Friend Finder Alert:</h4>
                </div>
                <div class="modal-body text-center">
                  <h3 id="friendName"></h3>
                  <img id="friendPhoto" src="https://scifanatic-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/picard-415x640.jpg" alt="Match Profile Pic">
                </div>
                <div class="modal-footer">
                  <button type="button" id="close" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
              </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
          </div><!-- /.modal -->       
        <script type="text/javascript">
            $("#submit").on("click", function(e) {
                e.preventDefault();
                function validateForm() {
                    var formValid = true;
                    $(".form-control").each(function() {
                        if ($(this).val() === "") {
                            formValid = false;
                        }
                    })
                    $(".chosen-select").each(function() {
                        if ($(this).val() === "") {
                            formValid = false;
                        }
                    })
                    return formValid;
                };
                if (validateForm() == true) {    
                    var surveyResults = {
                        name: $("#name").val().trim(),
                        photo: $("#photo").val().trim(),
                        ques: [$("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                            ]
                    };
                    var currentURL = window.location.origin;

                    $.post(currentURL + "/api/friends", surveyResults, 
                    function(data) {
                        $("#friendName").text("Your Perfect Friend is: " + data.friendName);
                        $("#friendPhoto").attr("src", data.friendPhoto);
                    });
                    $("#resultsModal").modal("show");
                } else {
                    $("#errorModal").modal("show");
                }
            })
        </script>
    </body>
</html>